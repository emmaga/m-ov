<div ng-controller="shopCartController as shopCart" ng-init="shopCart.beforeInit()">

    <form class="light-bg list  padding mod-inset-forms" style="padding-top: 72px;padding-bottom: 0 !important; margin-bottom: 0 !important" name="orderForm" ng-submit="orderForm.$valid && shopCartList.length>0 && shopCart.submitOrder()">

        <div class="ricepaper" style="position: fixed; padding: 10px;padding-bottom: 0; z-index: 10; top: 0; left: 0;width: 100%; background-color: rgba(255, 255, 255, .95)">
            
            <button id="payBtn" class="button button-assertive" ng-class="{disabled: !shopCart.checked || !orderForm.$valid}" type="submit" style="position: absolute; text-indent: 3px; top: 14px; right: 12px; padding-bottom: 0px;line-height: 42px; height: 42px;min-height: 42px;">
                {{'payNow' | translate}}
                <i class="icon ion-ios-arrow-right" style="position: relative; top: 2px;"></i>
            </button>
            <h3 class="mod-font-light mod-text-indent" style="width: calc(100% - 77px); white-space: nowrap; text-overflow: ellipsis; overflow: hidden;">
                {{'totalPrice' | translate}}:&nbsp¥{{shopCart.totalPrice | fenToYuan}}
                <small ng-if="shopCartList.hasEx">
                    (&nbsp{{'expressFeeIncluded' | translate}}¥{{shopCart.postage | fenToYuan}}&nbsp)
                    
                </small>
            </h3>
            <!-- <div class="mod-split-line mod-break-padding"></div> -->
        </div>



        <div class="item item-input mod-short">
            <div class="input-label">{{'contackName'|translate}}</div>
            <input type="text" ng-model="shopCart.address.name" required />
        </div>
        <div class="item item-input mod-short">
            <div class="input-label">{{'phoneNumber'|translate}}</div>
            <input type="text" ng-model="shopCart.address.mobile" required />
        </div>
        <ion-toggle ng-model="shopCartList.hasEx">{{'needDelivering'|translate}}?</ion-toggle>
        <div class="item" ng-if="!(shopCartList.hasEx)" style="height: 46px; line-height: 14px;">
            {{'placeOfTakingGoods'|translate}}&nbsp{{shopCart.hotelName}}
        </div>
        
        <div class="item item-input mod-short" ng-if="shopCartList.hasEx">
            <div class="input-label">{{'shipAdress'|translate}}</div>
            <input type="text" ng-model="shopCart.address.address" required/>
        </div>

    </form>
    <div class="list">
        <!-- <div class="item mod-ghost" style="height: 46px !important" ng-if="shopCartList.hasEx"></div> -->
        
        <p class="mod-note-emptylist" ng-show="shopCartList.length == 0">
            <i class="icon ion-ios-cart-outline"></i><br>
            {{'emptyCart'|translate}}
        </p>

        <!-- 第一个divider -->
        <div class="item item-divider" ng-if="shopCartList.length >= 1"></div>
        <!-- 卡片 -->
        <div class="card mod-flat mod-no-margin-vertical" ng-repeat-start="item in shopCartList track by $index">

            <div class="item item-checkbox item-icon-right assertive">
                <div class="checkbox checkbox-assertive">
                    <input ng-disabled="!item.status || item.availableCount==0 || (item.availableCount - item.count)<0" ng-model="item.checked" type="checkbox">
                </div>
                ￥{{item.price*item.count | fenToYuan}}
                <a class="icon ion-ios-trash-outline dark" ng-click="shopCart.delete($index)" style="font-size: 24px; z-index: 10"></a>
            </div>

            <div class="item item-thumbnail-left">
                <div class="full-image mod-cover mod-radius mod-img-in-thumbnail" style="background-image: url({{item.thumbnailSrc}});"></div>
                <h2>{{item.productName}}</h2>
                <p>{{'unitPrice'|translate}}:&nbsp￥{{item.price | fenToYuan}}</p>
            </div>
            <div class="item item-input">
                <div class="input-label">
                    <div ng-if="(item.availableCount - item.count) >= 0">{{'productQuantity'|translate}}</div>
                    <div ng-if="(item.availableCount - item.count) < 0" class="assertive">{{'exceedStock'|translate}}{{item.count - item.availableCount}}</div>
                </div>
                <a class="button button-small button-light icon ion-ios-minus-empty" ng-class="{disabled:( item.count <= 1)}" ng-click="shopCart.minusOne($index)"></a>
                <span class="mod-input-number">
                    {{item.count}}
                </span>
                <a class="button button-small button-light icon ion-ios-plus-empty" ng-class="{disabled:((item.availableCount - item.count) <= 0)}" ng-click="shopCart.plusOne($index)"></a>
            </div>
            <!-- <ion-toggle ng-model="item.dist">此商品需要配送？</ion-toggle> -->
            <div class="mod-cart-prod-disabled" ng-show="item.status==0 || item.availableCount==0">
                <a class="icon ion-ios-trash dark" ng-click="shopCart.delete($index)" style="position: absolute; font-size: 24px; right: 0; color: white; float: right; margin: 10px 30px; z-index: 2;"></a>
                <h2>
                    <i class="icon ion-heart-broken"></i>
                    <br>
                    <small ng-if="item.status==0">{{'goodsOffTheShelf'|translate}}</small>
                    <small ng-if="item.status!=0 && item.availableCount==0">{{'goodsSoldOut'|translate}}</small>
                </h2>
            </div>
        </div>
        <!-- 补色 -->
        <div class="item item-divider mod-last" ng-repeat-end="item in shopCartList track by $index" style="{{shopCartList.length == 1 ? 'height: calc(100vh - 486px); ' : ''}}"></div>
        <!-- 卡片 end -->
    </div>
</div>
